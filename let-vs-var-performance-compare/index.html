
<!DOCTYPE html>
<html lang="ko-KR">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="gomugom">
    <title>let과 var의 성능 비교 - gomugom</title>
    <meta name="author" content="gomugom">
    
        <meta name="keywords" content="ecmascript,javascript,class">
    
    
        <link rel="icon" href="http://gomugom.github.io/assets/images/favicon.ico">
    
    
    <meta name="description" content="며칠 전 김영보 강사님의 다음 글을 읽고 의문이 들어 직접 ES6의 let과 기존의 var의 성능 차이를 비교한 실험을 해보면서 그 내용을 정리하여 포스팅한다. 모든 테스트는 MacOS 10.11.6 / Chrome 55.0.2283.95 버전에서 수행하였다.">
<meta property="og:type" content="blog">
<meta property="og:title" content="let과 var의 성능 비교">
<meta property="og:url" content="http://gomugom.github.io/let-vs-var-performance-compare/index.html">
<meta property="og:site_name" content="gomugom">
<meta property="og:description" content="며칠 전 김영보 강사님의 다음 글을 읽고 의문이 들어 직접 ES6의 let과 기존의 var의 성능 차이를 비교한 실험을 해보면서 그 내용을 정리하여 포스팅한다. 모든 테스트는 MacOS 10.11.6 / Chrome 55.0.2283.95 버전에서 수행하였다.">
<meta property="og:updated_time" content="2017-01-11T07:24:12.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="let과 var의 성능 비교">
<meta name="twitter:description" content="며칠 전 김영보 강사님의 다음 글을 읽고 의문이 들어 직접 ES6의 let과 기존의 var의 성능 차이를 비교한 실험을 해보면서 그 내용을 정리하여 포스팅한다. 모든 테스트는 MacOS 10.11.6 / Chrome 55.0.2283.95 버전에서 수행하였다.">
    
    
        
    
    
        <meta property="og:image" content="https://www.gravatar.com/avatar/02e9f56a3202da2e6e0e36a5a23facbb?s=640"/>
    
    
        <meta property="og:image" content="http://gomugom.github.io/let-vs-var-performance-compare/../images/category-es.png"/>
        <meta class="swiftype" name="image" data-type="enum" content="http://gomugom.github.io/let-vs-var-performance-compare/../images/category-es.png" />
    
    
        <meta property="og:image" content="http://gomugom.github.io/let-vs-var-performance-compare/../images/post-cover4.jpg"/>
        <meta class="swiftype" name="image" data-type="enum" content="http://gomugom.github.io/let-vs-var-performance-compare/../images/post-cover4.jpg" />
    
    
    <!--STYLES-->
    <link rel="stylesheet" href="/assets/css/style-cromvcxflqm9uy3wtwcd24guzggf1mz92e32vzhe4tc9bepwgpebspwcdgnp.min.css">
    <!--STYLES END-->
    
    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    
        
    

<header id="header" data-behavior="4">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a class="header-title-link" href="/ ">gomugom</a>
    </div>
    
        
            <a  class="header-right-picture "
                href="#about">
        
        
            <img class="header-picture" src="https://www.gravatar.com/avatar/02e9f56a3202da2e6e0e36a5a23facbb?s=90" alt="Author&#39;s picture"/>
        
        </a>
    
</header>

            <!-- Define author's picture -->


    

<nav id="sidebar" data-behavior="4">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a href="/#about">
                    <img class="sidebar-profile-picture" src="https://www.gravatar.com/avatar/02e9f56a3202da2e6e0e36a5a23facbb?s=110" alt="Author&#39;s picture"/>
                </a>
                <h4 class="sidebar-profile-name">gomugom</h4>
                
                    <h5 class="sidebar-profile-bio"><p>호기심 많고 열정 넘치는 초보 개발자입니다. 도전을 좋아하며 매사를 즐기고자 노력합니다.</p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/ "
                            
                        >
                    
                        <i class="sidebar-button-icon fa fa-lg fa-home"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/categories"
                            
                        >
                    
                        <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
                        <span class="sidebar-button-desc">Categories</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/tags"
                            
                        >
                    
                        <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
                        <span class="sidebar-button-desc">Tags</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/archives"
                            
                        >
                    
                        <i class="sidebar-button-icon fa fa-lg fa-archive"></i>
                        <span class="sidebar-button-desc">Archives</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/works"
                            
                        >
                    
                        <i class="sidebar-button-icon fa fa-lg fa-cubes"></i>
                        <span class="sidebar-button-desc">Works</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="https://github.com/gomugom" target="_blank">
                    
                        <i class="sidebar-button-icon fa fa-lg fa-github"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="https://facebook.com/gomugomm" target="_blank">
                    
                        <i class="sidebar-button-icon fa fa-lg fa-facebook"></i>
                        <span class="sidebar-button-desc">Facebook</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="https://www.linkedin.com/in/%EC%9E%AC%EB%82%A8-%EC%A0%95-206124105" target="_blank">
                    
                        <i class="sidebar-button-icon fa fa-lg fa-linkedin"></i>
                        <span class="sidebar-button-desc">LinkedIn</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="mailto:power4ce@gmail.com" target="_blank">
                    
                        <i class="sidebar-button-icon fa fa-lg fa-envelope-o"></i>
                        <span class="sidebar-button-desc">Mail</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
        <div class="post-header-cover
                    text-left
                    post-header-cover--partial"
             style="background-image:url('/let-vs-var-performance-compare/../images/post-cover4.jpg');"
             data-behavior="4">
            
                <div class="post-header main-content-wrap text-left">
    
        <h1 class="post-title" itemprop="headline">
            let과 var의 성능 비교
        </h1>
    
    <div class="post-meta">
    <time itemprop="datePublished" datetime="2017-01-10T18:26:03+09:00">
	
		    2017. 01. 10
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/ecmascript/">ECMAScript</a>


    
</div>

</div>
            
        </div>

            <div id="main" data-behavior="4"
                 class="hasCover
                        hasCoverMetaIn
                        ">
                
<article class="post" itemscope itemType="http://schema.org/BlogPosting">
    
    
    <div class="post-content markdown" itemprop="articleBody">
        <div class="main-content-wrap">
            <p>며칠 전 김영보 강사님의 다음 글을 읽고 의문이 들어 직접 ES6의 <code>let</code>과 기존의 <code>var</code>의 성능 차이를 비교한 실험을 해보면서 그 내용을 정리하여 포스팅한다. 모든 테스트는 MacOS 10.11.6 / Chrome 55.0.2283.95 버전에서 수행하였다.</p>
<a id="more"></a>
<blockquote>
<p>[자바스크립트 let과 var에 대한 생각 - 김영보]<br>ES6에서 let 변수가 생겼으며 이는 블록 스코프를 갖는 것이 특징이다.<br>한편, 블록 스코프를 갖기 위해서는 별도의 처리가 동반된다. 즉, 엔진이 별도의 스코프를 관리해야 하며 여기에 let 변수를 설정해야 한다. 함수의 if 문 안에 let 변수를 사용했을 때 블록 스코프가 생기며, 이는 함수도 블록 스코프이므로 구조적, 계층적으로 스코프를 만드는 모습이 된다. 엔진의 처리 속도에 영향을 미치는 스코프 체인과 유사한 모습으로 이를 보완하기 위해 ES5에서 정적 환경으로 바꾸었다.<br>let 변수는 var 키워드를 사용하지 않아 글로벌 오브젝트에 변수가 설정되는 것을 방지하기 위한 것과 C++와 같은 다른 언어의 블록 스코프를 자바스크립트에 적용한 것이다. 즉, 모든 경우에 let 변수를 사용해야 하는 것은 아니다. 단일 스코프가 엔진 처리의 효율을 높일 수 있다.<br>블록 단위로 스코프를 구분해야 하는 특별한 경우에는 유용하지만, 이에 따른 엔진 처리의 부하도 고려해야 한다. 반드시 구분해야 하는 상황에서 사용하는 것이 좋으며, 일반적인 경우에는 var 변수가 더 효율적이라고 할 수 있다.</p>
</blockquote>
<h2 id="테스팅-방식"><a href="#테스팅-방식" class="headerlink" title="테스팅 방식"></a>테스팅 방식</h2><p>가급적 단순한 소스로 빠르게 테스트를 하기 위해, 테스팅 방법은 다음 함수를 이용하였다. 모든 테스트는 세 번씩 독립시행하였다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> timeCheck = <span class="function">(<span class="params">times, test</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">var</span> res = <span class="number">0</span>, t1, t2;</div><div class="line">  <span class="keyword">while</span>(times-- &gt; <span class="number">0</span>) &#123;</div><div class="line">    t1 = <span class="built_in">window</span>.performance.now();</div><div class="line">    test();</div><div class="line">    t2 = <span class="built_in">window</span>.performance.now();</div><div class="line">    res += t1 - t2;</div><div class="line">  &#125;</div><div class="line">  <span class="built_in">console</span>.log(test.name, res / times);</div><div class="line">&#125;</div><div class="line"><span class="keyword">const</span> compare = <span class="function">(<span class="params">times, ...tests</span>) =&gt;</span> &#123;</div><div class="line">  tests.forEach(<span class="function"><span class="params">test</span> =&gt;</span> timeCheck(times, test));</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="for문-내부에서-변수-선언"><a href="#for문-내부에서-변수-선언" class="headerlink" title="for문 내부에서 변수 선언"></a>for문 내부에서 변수 선언</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> testVar = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt;= <span class="number">10000</span>; i++) &#123; <span class="keyword">var</span> a = i * <span class="number">10</span> &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">const</span> testLet = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt;= <span class="number">10000</span>; i++) &#123; <span class="keyword">let</span> a = i * <span class="number">10</span> &#125;</div><div class="line">&#125;</div><div class="line">compare(<span class="number">100000</span>, testVar, testLet);</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">/* 결과 */</span></div><div class="line">testVar <span class="number">258.1824999999985</span></div><div class="line">testLet <span class="number">866.1525000000115</span></div><div class="line"></div><div class="line">testVar <span class="number">256.9074999998229</span></div><div class="line">testLet <span class="number">878.5875000000633</span></div><div class="line"></div><div class="line">testVar <span class="number">253.18500000071072</span></div><div class="line">testLet <span class="number">889.5424999998431</span></div></pre></td></tr></table></figure>
<p>3배 정도의 성능차이가 보인다. var는 블록스코프에 제한되지 않으며 재선언시 기존 변수를 그대로 활용하는 반면, let은 for문의 블록스코프에 의해 iterating 과정에서 매 번 새로 선언되므로, 이러한 차이는 당연한 결과인 듯 하다.</p>
<h2 id="for문-외부에서-변수-선언"><a href="#for문-외부에서-변수-선언" class="headerlink" title="for문 외부에서 변수 선언"></a>for문 외부에서 변수 선언</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> testVar = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> i = <span class="number">0</span></div><div class="line">  <span class="keyword">for</span>( ; i &lt;= <span class="number">10000</span>; i++) &#123; <span class="keyword">var</span> a = i * <span class="number">10</span> &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">const</span> testLet = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">  <span class="keyword">let</span> i = <span class="number">0</span></div><div class="line">  <span class="keyword">for</span>( ; i &lt;= <span class="number">10000</span>; i++) &#123; <span class="keyword">let</span> a = i * <span class="number">10</span> &#125;</div><div class="line">&#125;</div><div class="line">compare(<span class="number">100000</span>, testVar, testLet);</div><div class="line"></div><div class="line"><span class="comment">/* 결과 */</span></div><div class="line">testVar <span class="number">258.77999999998656</span></div><div class="line">testLet <span class="number">257.6199999999908</span></div><div class="line"></div><div class="line">testVar <span class="number">258.78000000000156</span></div><div class="line">testLet <span class="number">253.9850000000024</span></div><div class="line"></div><div class="line">testVar <span class="number">252.57999999999174</span></div><div class="line">testLet <span class="number">254.11499999998796</span></div></pre></td></tr></table></figure>
<p>엎치락 뒤치락 한다. 유의미한 차이가 있다고 보기는 힘들다.</p>
<h2 id="var와-let의-혼용-비교"><a href="#var와-let의-혼용-비교" class="headerlink" title="var와 let의 혼용 비교"></a>var와 let의 혼용 비교</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> testVar = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> i = <span class="number">0</span>, sum = <span class="number">0</span>;</div><div class="line">  <span class="keyword">for</span>( ; i &lt;= <span class="number">10000</span>; i++) &#123; sum += i; &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">const</span> testLet = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> i = <span class="number">0</span>, sum = <span class="number">0</span>;</div><div class="line">  <span class="keyword">for</span>( ; i &lt;= <span class="number">10000</span>; i++) &#123; sum += i; &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">const</span> testVarAndLet1 = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> i = <span class="number">0</span>;</div><div class="line">  <span class="keyword">var</span> sum = <span class="number">0</span>;</div><div class="line">  <span class="keyword">for</span>( ; i &lt;= <span class="number">10000</span>; i++) &#123; sum += i; &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">const</span> testVarAndLet2 = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> i = <span class="number">0</span>;</div><div class="line">  <span class="keyword">let</span> sum = <span class="number">0</span>;</div><div class="line">  <span class="keyword">for</span>( ; i &lt;= <span class="number">10000</span>; i++) &#123; sum += i; &#125;</div><div class="line">&#125;</div><div class="line">compare(<span class="number">100000</span>, testVar, testLet, testVarAndLet1, testVarAndLet2);</div><div class="line"></div><div class="line"><span class="comment">/* 결과 */</span></div><div class="line">testVar <span class="number">328.94750000005934</span></div><div class="line">testLet <span class="number">1971.6525000000265</span></div><div class="line">testVarAndLet1 <span class="number">329.54000000009637</span></div><div class="line">testVarAndLet2 <span class="number">1987.0774999999967</span></div><div class="line"></div><div class="line">testVar <span class="number">329.9424999997682</span></div><div class="line">testLet <span class="number">1938.6849999998158</span></div><div class="line">testVarAndLet1 <span class="number">337.06249999996726</span></div><div class="line">testVarAndLet2 <span class="number">1977.209999999879</span></div><div class="line"></div><div class="line">testVar <span class="number">332.9599999998718</span></div><div class="line">testLet <span class="number">1969.6900000002897</span></div><div class="line">testVarAndLet1 <span class="number">335.554999999782</span></div><div class="line">testVarAndLet2 <span class="number">1982.3450000001758</span></div></pre></td></tr></table></figure>
<p>흥미로운 결과이지만, 스코프에 따른 비용을 생각하면 당연한 결과이기도 하다. for문에 의한 블록스코프 내부에서 let으로 선언한 <code>sum</code>에 접근하기 위해서는 스코프체이닝을 한 단계 거쳐야 하기 때문에 더 많은 비용이 발생한다는 것이다. 아마도 김영보 강사님께서는 이 부분을 말씀하고자 하셨던 것 같다.</p>
<h2 id="그렇다면-내장-메소드를-활용한다면-어떨까"><a href="#그렇다면-내장-메소드를-활용한다면-어떨까" class="headerlink" title="그렇다면 내장 메소드를 활용한다면 어떨까?"></a>그렇다면 내장 메소드를 활용한다면 어떨까?</h2><p>for문을 forEach로 대체한 경우와 reduce를 이용한 직접계산 방식을 테스트해보자.</p>
<h3 id="1-forEach로-전환"><a href="#1-forEach로-전환" class="headerlink" title="1. forEach로 전환"></a>1. forEach로 전환</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> testVar = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> sum = <span class="number">0</span>;</div><div class="line">  <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">10000</span>).fill(<span class="number">0</span>).forEach(<span class="function">(<span class="params">v, i</span>) =&gt;</span> &#123; sum += i; &#125;);</div><div class="line">&#125;</div><div class="line"><span class="keyword">const</span> testLet = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> sum = <span class="number">0</span>;</div><div class="line">  <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">10000</span>).fill(<span class="number">0</span>).forEach(<span class="function">(<span class="params">v, i</span>) =&gt;</span> &#123; sum += i; &#125;);</div><div class="line">&#125;</div><div class="line">compare(<span class="number">10000</span>, testVar, testLet);</div><div class="line"></div><div class="line"><span class="comment">/* 결과 */</span></div><div class="line">testVar <span class="number">916.9325000000117</span></div><div class="line">testLet <span class="number">1261.5850000000355</span></div><div class="line"></div><div class="line">testVar <span class="number">918.6650000000309</span></div><div class="line">testLet <span class="number">1298.54500000001</span></div><div class="line"></div><div class="line">testVar <span class="number">884.2624999999607</span></div><div class="line">testLet <span class="number">1285.3525000000227</span></div></pre></td></tr></table></figure>
<h3 id="2-reduce로-직접-계산"><a href="#2-reduce로-직접-계산" class="headerlink" title="2. reduce로 직접 계산"></a>2. reduce로 직접 계산</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> testVar = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> sum = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">10000</span>).fill(<span class="number">0</span>).reduce(<span class="function">(<span class="params">a, b, i</span>) =&gt;</span> a + i, <span class="number">0</span>);</div><div class="line">&#125;</div><div class="line"><span class="keyword">const</span> testLet = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> sum = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">10000</span>).fill(<span class="number">0</span>).reduce(<span class="function">(<span class="params">a, b, i</span>) =&gt;</span> a + i, <span class="number">0</span>);</div><div class="line">&#125;</div><div class="line">compare(<span class="number">10000</span>, testVar, testLet);</div><div class="line"></div><div class="line"><span class="comment">/* 결과 */</span></div><div class="line">testVar <span class="number">904.6750000000009</span></div><div class="line">testLet <span class="number">915.0900000000024</span></div><div class="line"></div><div class="line">testVar <span class="number">903.6025000000136</span></div><div class="line">testLet <span class="number">892.7199999999839</span></div><div class="line"></div><div class="line">testVar <span class="number">891.3525000000091</span></div><div class="line">testLet <span class="number">882.7275000000318</span></div></pre></td></tr></table></figure>
<p>forEach로 같은 연산을 수행하기 위해서는 외부 스코프의 변수 <code>sum</code>을 갱신하여야 하는데, 이런 경우에는 <code>let</code>이 <code>var</code>보다 더 큰 비용을 필요로 하는 것으로 보인다. 한편 reduce를 이용하면 메소드 내부에서 외부 스코프의 변수를 호출할 일이 없으므로 상대적으로 매우 양호한 성능을 보이며, <code>let</code>과 <code>var</code> 사이의 차이는 없는 것으로 확인된다.<br>이러한 차이에 대해 보다 자세히 확인하기 전에, 변인을 통제하기 위해 스코프 자체의 생성 비용을 먼저 확인해볼 필요가 있을 것 같다.</p>
<h2 id="내부-스코프가-없는-경우-vs-즉시실행함수-vs-블록스코프"><a href="#내부-스코프가-없는-경우-vs-즉시실행함수-vs-블록스코프" class="headerlink" title="내부 스코프가 없는 경우 vs. 즉시실행함수 vs. 블록스코프"></a>내부 스코프가 없는 경우 vs. 즉시실행함수 vs. 블록스코프</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> testNoScopeVar = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> sum = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">1000</span>).fill(<span class="number">0</span>).join(<span class="string">''</span>);</div><div class="line">&#125;</div><div class="line"><span class="keyword">const</span> testNoScopeLet = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> sum = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">1000</span>).fill(<span class="number">0</span>).join(<span class="string">''</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> testFunctionScope = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> sum = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">1000</span>).fill(<span class="number">0</span>).join(<span class="string">''</span>);</div><div class="line">  &#125;)();</div><div class="line">&#125;</div><div class="line"><span class="keyword">const</span> testBlockScope = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  &#123;</div><div class="line">    <span class="keyword">let</span> sum = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">1000</span>).fill(<span class="number">0</span>).join(<span class="string">''</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line">compare(<span class="number">100000</span>, testNoScopeVar, testNoScopeLet, testFunctionScope, testBlockScope);</div><div class="line"></div><div class="line"><span class="comment">/* 결과 */</span></div><div class="line">testNoScopeVar <span class="number">1601.9000000000224</span></div><div class="line">testNoScopeLet <span class="number">1586.9125000000586</span></div><div class="line">testFunctionScope <span class="number">1588.4724999999517</span></div><div class="line">testBlockScope <span class="number">1582.192499999961</span></div><div class="line"></div><div class="line">testNoScopeVar <span class="number">1594.0849999999155</span></div><div class="line">testNoScopeLet <span class="number">1593.0999999999785</span></div><div class="line">testFunctionScope <span class="number">1706.752500000075</span></div><div class="line">testBlockScope <span class="number">1641.9625000000942</span></div><div class="line"></div><div class="line">testNoScopeVar <span class="number">1670.175000000112</span></div><div class="line">testNoScopeLet <span class="number">1708.109999999855</span></div><div class="line">testFunctionScope <span class="number">1678.099999999955</span></div><div class="line">testBlockScope <span class="number">1670.0550000006842</span></div></pre></td></tr></table></figure>
<p>놀랍게도 스코프 생성 자체는 성능상에 거의 아무런 영향을 주지 않는 것으로 확인된다. 혹시 내부에서 스코프가 한 번만 형성되어서 그런 것일까?</p>
<h2 id="스코프를-1000회-생성"><a href="#스코프를-1000회-생성" class="headerlink" title="스코프를 1000회 생성"></a>스코프를 1000회 생성</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> testFunctionScope = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">1000</span>).fill(<span class="number">0</span>).forEach(<span class="function"><span class="params">_</span>=&gt;</span> &#123;</div><div class="line">    (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">      <span class="keyword">var</span> sum = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">1000</span>).fill(<span class="number">0</span>).join(<span class="string">''</span>);</div><div class="line">    &#125;)();</div><div class="line">  &#125;);</div><div class="line">&#125;</div><div class="line"><span class="keyword">const</span> testBlockScope = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">1000</span>).fill(<span class="number">0</span>).forEach(<span class="function"><span class="params">_</span>=&gt;</span> &#123;</div><div class="line">    &#123;</div><div class="line">      <span class="keyword">let</span> sum = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">1000</span>).fill(<span class="number">0</span>).join(<span class="string">''</span>);</div><div class="line">    &#125;</div><div class="line">  &#125;);</div><div class="line">&#125;</div><div class="line">compare(<span class="number">1000</span>, testFunctionScope, testBlockScope);</div><div class="line"></div><div class="line"><span class="comment">/* 결과 */</span></div><div class="line">testFunctionScope <span class="number">16264.852499999985</span></div><div class="line">testBlockScope <span class="number">15813.532500000016</span></div><div class="line"></div><div class="line">testFunctionScope <span class="number">16406.502499999522</span></div><div class="line">testBlockScope <span class="number">16261.40749999987</span></div><div class="line"></div><div class="line">testFunctionScope <span class="number">16506.43499999994</span></div><div class="line">testBlockScope <span class="number">16097.730000000083</span></div></pre></td></tr></table></figure>
<p>이정도면 블록스코프와 즉시실행함수의 속도차이는 없다고 보아야 할 것이다. 그렇다면 이제 <code>let</code>과 <code>var</code>이 외부 스코프의 변수를 갱신하는 데에 드는 비용을 확인해볼 수 있겠다.</p>
<h2 id="외부스코프에-대한-비용-비교-1"><a href="#외부스코프에-대한-비용-비교-1" class="headerlink" title="외부스코프에 대한 비용 비교 - 1"></a>외부스코프에 대한 비용 비교 - 1</h2><p>반복을 위한 함수선언 자체가 새로운 스코프를 만들게 되므로, 이런 변인을 통제(새로운 스코프 형성 없이 테스트)하기 위해 무식한 소스를 작성해보았다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> testFunctionScopeVar = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> sum = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">10000</span>).fill(<span class="number">0</span>);</div><div class="line">  (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; sum = sum.join(<span class="string">''</span>); &#125;)();</div><div class="line">  sum = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">10000</span>).fill(<span class="number">0</span>);</div><div class="line">  (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; sum = sum.join(<span class="string">''</span>); &#125;)();</div><div class="line">  sum = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">10000</span>).fill(<span class="number">0</span>);</div><div class="line">  (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; sum = sum.join(<span class="string">''</span>); &#125;)();</div><div class="line">  sum = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">10000</span>).fill(<span class="number">0</span>);</div><div class="line">  (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; sum = sum.join(<span class="string">''</span>); &#125;)();</div><div class="line">  sum = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">10000</span>).fill(<span class="number">0</span>);</div><div class="line">  (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; sum = sum.join(<span class="string">''</span>); &#125;)();</div><div class="line">&#125;</div><div class="line"><span class="keyword">const</span> testFunctionScopeLet = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> sum = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">10000</span>).fill(<span class="number">0</span>);</div><div class="line">  (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; sum = sum.join(<span class="string">''</span>); &#125;)();</div><div class="line">  sum = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">10000</span>).fill(<span class="number">0</span>);</div><div class="line">  (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; sum = sum.join(<span class="string">''</span>); &#125;)();</div><div class="line">  sum = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">10000</span>).fill(<span class="number">0</span>);</div><div class="line">  (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; sum = sum.join(<span class="string">''</span>); &#125;)();</div><div class="line">  sum = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">10000</span>).fill(<span class="number">0</span>);</div><div class="line">  (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; sum = sum.join(<span class="string">''</span>); &#125;)();</div><div class="line">  sum = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">10000</span>).fill(<span class="number">0</span>);</div><div class="line">  (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; sum = sum.join(<span class="string">''</span>); &#125;)()</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> testBlockScopeVar = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> sum = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">10000</span>).fill(<span class="number">0</span>);</div><div class="line">  &#123; sum = sum.join(<span class="string">''</span>); &#125;</div><div class="line">  sum = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">10000</span>).fill(<span class="number">0</span>);</div><div class="line">  &#123; sum = sum.join(<span class="string">''</span>); &#125;</div><div class="line">  sum = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">10000</span>).fill(<span class="number">0</span>);</div><div class="line">  &#123; sum = sum.join(<span class="string">''</span>); &#125;</div><div class="line">  sum = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">10000</span>).fill(<span class="number">0</span>);</div><div class="line">  &#123; sum = sum.join(<span class="string">''</span>); &#125;</div><div class="line">  sum = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">10000</span>).fill(<span class="number">0</span>);</div><div class="line">  &#123; sum = sum.join(<span class="string">''</span>); &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">const</span> testBlockScopeLet = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> sum = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">10000</span>).fill(<span class="number">0</span>);</div><div class="line">  &#123; sum = sum.join(<span class="string">''</span>); &#125;</div><div class="line">  sum = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">10000</span>).fill(<span class="number">0</span>);</div><div class="line">  &#123; sum = sum.join(<span class="string">''</span>); &#125;</div><div class="line">  sum = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">10000</span>).fill(<span class="number">0</span>);</div><div class="line">  &#123; sum = sum.join(<span class="string">''</span>); &#125;</div><div class="line">  sum = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">10000</span>).fill(<span class="number">0</span>);</div><div class="line">  &#123; sum = sum.join(<span class="string">''</span>); &#125;</div><div class="line">  sum = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">10000</span>).fill(<span class="number">0</span>);</div><div class="line">  &#123; sum = sum.join(<span class="string">''</span>); &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">compare(<span class="number">1000</span>, testFunctionScopeVar, testFunctionScopeLet, testBlockScopeVar, testBlockScopeLet);</div><div class="line"></div><div class="line"><span class="comment">/* 결과 */</span></div><div class="line">testFunctionScopeVar <span class="number">798.4200000000856</span></div><div class="line">testFunctionScopeLet <span class="number">781.6874999999345</span></div><div class="line">testBlockScopeVar <span class="number">786.3724999999904</span></div><div class="line">testBlockScopeLet <span class="number">779.984999999986</span></div><div class="line"></div><div class="line">testFunctionScopeVar <span class="number">798.8450000002049</span></div><div class="line">testFunctionScopeLet <span class="number">850.8949999999168</span></div><div class="line">testBlockScopeVar <span class="number">860.9525000000867</span></div><div class="line">testBlockScopeLet <span class="number">822.717499999897</span></div><div class="line"></div><div class="line">testFunctionScopeVar <span class="number">829.2199999999721</span></div><div class="line">testFunctionScopeLet <span class="number">821.3075000001991</span></div><div class="line">testBlockScopeVar <span class="number">856.947499999922</span></div><div class="line">testBlockScopeLet <span class="number">799.0949999999866</span></div></pre></td></tr></table></figure>
<p>이상하다. 앞서 테스트에서는 분명 블록스코프를 형성하는 for문에서 외부스코프에 접근할 때에 비용 차이가 있었는데, 이번에는 그 차이가 전혀 보이지 않는다. for문을 가지고 다른 변인통제장치를 마련하여 다시 한 번 테스트 해보자.</p>
<h2 id="외부스코프에-대한-비용-비교-2-for문"><a href="#외부스코프에-대한-비용-비교-2-for문" class="headerlink" title="외부스코프에 대한 비용 비교 - 2. for문"></a>외부스코프에 대한 비용 비교 - 2. for문</h2><p>for문은 자체적으로 블록스코프를 형성하므로, 블록스코프와 즉시실행함수의 성능 차이가 거의 없다는 전제하에 var에 대해서도 let과 마찬가지로 외부스코프의 변수에 접근하게끔 for문 내부에 즉시실행함수를 넣어보았다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> testVarNoScope = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> sum = <span class="number">0</span>;</div><div class="line">  <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span> ; i &lt;= <span class="number">10000</span>; i++) &#123;</div><div class="line">    sum += i;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">const</span> testVar = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> sum = <span class="number">0</span>;</div><div class="line">  <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span> ; i &lt;= <span class="number">10000</span>; i++) &#123;</div><div class="line">    (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; sum += i; &#125;)();</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">const</span> testLet = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> sum = <span class="number">0</span>;</div><div class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span> ; i &lt;= <span class="number">10000</span>; i++) &#123;</div><div class="line">    sum += i;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">const</span> testLetWithFunctionScope = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> sum = <span class="number">0</span>;</div><div class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span> ; i &lt;= <span class="number">10000</span>; i++) &#123;</div><div class="line">    (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; sum += i; &#125;)();</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">const</span> testLetWithBlockScope = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> sum = <span class="number">0</span>;</div><div class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span> ; i &lt;= <span class="number">10000</span>; i++) &#123;</div><div class="line">    &#123; sum += i; &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line">compare(<span class="number">10000</span>, testVar, testLet, testLetWithFunctionScope, testLetWithBlockScope);</div><div class="line"></div><div class="line">testVarNoScope <span class="number">35.77249999992273</span></div><div class="line">testVar <span class="number">1163.234999999855</span></div><div class="line">testLet <span class="number">504.2325000000492</span></div><div class="line">testLetWithFunctionScope <span class="number">4295.67250000003</span></div><div class="line">testLetWithBlockScope <span class="number">500.6700000000783</span></div><div class="line"></div><div class="line">testVarNoScope <span class="number">36.612500000046566</span></div><div class="line">testVar <span class="number">1221.842499999766</span></div><div class="line">testLet <span class="number">518.9699999999648</span></div><div class="line">testLetWithFunctionScope <span class="number">4509.729999999974</span></div><div class="line">testLetWithBlockScope <span class="number">549.4775000002774</span></div><div class="line"></div><div class="line">testVarNoScope <span class="number">36.07249999981286</span></div><div class="line">testVar <span class="number">1247.2349999999278</span></div><div class="line">testLet <span class="number">518.7849999999453</span></div><div class="line">testLetWithFunctionScope <span class="number">4420.822500000126</span></div><div class="line">testLetWithBlockScope <span class="number">504.9025000000038</span></div></pre></td></tr></table></figure>
<p>스코프가 전혀 중첩되지 않은 첫번째의 결과가 가장 뛰어나고, 그 다음으로는 블록스코프 하나(for문 자체)로 이루어진 세번째 및 블록스코프 둘(for문 자체 + 내부)로 이루어진 다섯번째 결과가 동일한 성능을 보이고 있다. 반면 즉시실행함수는 상당한 비용을 소모하는 것으로 확인된다. 네번째 결과가 훨씬 높게 나타난 이유는 두번째와 비교해 스코프 중첩이 한 번 더 있기 때문이 아닐까 추측된다.</p>
<h2 id="let이나-const-선언이-없다면-블록스코프가-생성되지-않는가"><a href="#let이나-const-선언이-없다면-블록스코프가-생성되지-않는가" class="headerlink" title="let이나 const 선언이 없다면 블록스코프가 생성되지 않는가?"></a><code>let</code>이나 <code>const</code> 선언이 없다면 블록스코프가 생성되지 않는가?</h2><p>강사님께서는 <code>함수의 if 문 안에 let 변수를 사용했을 때 블록 스코프가 생기며</code> 라고도 하셨는데, tc39의 <a href="http://www.ecma-international.org/ecma-262/6.0/#sec-lexical-environments" target="_blank" rel="external">ECMAScript2015 Specfication - Lexical Environments</a>는 다음과 같이 기술하고 있다.</p>
<blockquote>
<p>A Lexical Environment is a specification type used to define the association of Identifiers to specific variables and functions based upon the lexical nesting structure of ECMAScript code. (중략) Usually a Lexical Environment is associated with some specific syntactic structure of ECMAScript code such as a FunctionDeclaration, a BlockStatement, or a Catch clause of a TryStatement and a new Lexical Environment is created each time such code is evaluated.</p>
<blockquote>
<p>(발번역 주의) 렉시컬 환경은 ECMAScript 코드의 렉시컬 중첩구조를 기반으로 식별자(identifier)와 특정 변수 및 함수와의 연관성을 정의하기 위한 스펙 유형이다. 렉시컬 환경은 일반적으로 <code>Function Declaration</code>, <code>Block Statement</code>, <code>try</code>구문의 <code>catch</code> 절과 같은 ECMAScript 코드의 특정 구문 구조와 연결되며, 이러한 코드가 평가될 때마다 새로운 렉시컬 환경이 생성된다.</p>
</blockquote>
</blockquote>
<p>즉 ‘block statement’가 평가될 때마다 새로운 렉시컬 환경이 생성되며, 이 때 블록스코프가 생성되는 것으로 보아야 할 것이다. 따라서 let이나 const 선언 유무와 무관하게 블록스코프는 무조건 형성된다고 볼 수 있다.<br>기존의 함수 내부에 <code>var</code> 변수를 선언하든 하지 않든 함수스코프가 생성되는 것에는 어떠한 영향도 주지 않는 것과 마찬가지로 말이다.</p>
<h2 id="결론"><a href="#결론" class="headerlink" title="결론"></a>결론</h2><ul>
<li><p>다양한 테스트를 통해 블록스코프와 즉시실행함수 자체의 비용 차이는 크지 않은 것으로 확인되었다.</p>
</li>
<li><p>스코프체이닝으로 외부 변수에 엑세스할 때의 비용 역시 <code>var</code>와 <code>let</code>이 큰 차이를 보이지 않는다.</p>
</li>
<li><p>그러나 <code>if</code>나 <code>for</code> 처럼 그 자체가 블록스코프를 지니는 경우, 그 중에서도 ‘statement’ 외부의 변수를 내부에서 사용하는 경우에는 블록스코프의 영향에서 자유로운 <code>var</code>를 활용하는 편이 더 좋은 성능을 발휘한다.</p>
</li>
</ul>
<ul>
<li>블록스코프가 <code>if문 안에 let 변수를 사용했을 때 생긴다</code>는 것은 잘못 되었다. 블록스코프는 <code>for</code>, <code>while</code>, <code>switch</code> 등의 ‘block statement’에서 무조건 형성된다. 심지어 어떠한 명령어 없이 <code>{ }</code>만 묶는 것 만으로도 블록스코프가 형성된다.</li>
<li><p><em>단일 스코프가 엔진 처리의 효율을 높인다</em>. 스코프 체이닝을 최소화하는 것이 성능에 유의미한 영향을 준다는 점은 당연한 사실이다.</p>
</li>
<li><p><em>일반적인 경우 var 변수가 더 효율적</em> 인지 여부는 ‘그 때 그 때 다르다’고 봐야 할 것 같다. ‘일반적인 경우’를 어떻게 해석하느냐에 따라 달라질 문제이긴 하지만, ‘블록 단위로 스코프를 구분해야 하는 특별한 경우’란 늘상 존재하며 오히려 이것이 일반적이라고 볼 수 있지 않나 싶다. 기존의 코딩스타일 안에서 새로운 문법시스템을 판단하는 것 자체가 잘못된 접근일 수 있다는 생각이다. 기왕 블록스코프가 도입된 이상 블록스코프 내에서 독립적으로 처리할 방안(<code>reduce</code> 등)을 고민하고, 마땅한 수단이 없는 경우에 한해 부득이 블록스코프의 영향에서 자유로운 <code>var</code>로 접근하는 편이 더 낫지 않을까 한다.</p>
</li>
<li><p>불과 1년 전 <code>var와 let의 성능비교</code> 테스트에 대한 블로그 포스팅을 읽었었는데, 당시에는 <code>var</code>가 <code>let</code>보다 압도적으로 빠른 연산을 수행했던 것으로 기억한다. 그 1년 사이 둘의 성능은 같아졌다. 그만큼 최적화가 이루어져왔었기 때문이다. 그렇다면 앞서 확인했던 외부스코프에 대한 접근 성능 역시 점차 최적화가 될 것이라 기대한다.</p>
</li>
</ul>

            
        </div>
    </div>
    <div id="post-footer" class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">TAGGED IN</span><br/>
                
    <a class="tag tag--primary tag--small t-link" href="/tags/ecmascript/">ecmascript</a> <a class="tag tag--primary tag--small t-link" href="/tags/es2015/">es2015</a> <a class="tag tag--primary tag--small t-link" href="/tags/es6/">es6</a> <a class="tag tag--primary tag--small t-link" href="/tags/javascript/">javascript</a> <a class="tag tag--primary tag--small t-link" href="/tags/let/">let</a> <a class="tag tag--primary tag--small t-link" href="/tags/scope/">scope</a> <a class="tag tag--primary tag--small t-link" href="/tags/var/">var</a>

            </div>
        
        <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--disabled">
                
                    <i class="fa fa-angle-left"></i>
                    <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                </a>
            </li>
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--default tooltip--top" href="/ecmascript-proposals-1-intro/" data-tooltip="ECMAScript Proposals 1 - ES2016 &amp; ES2017">
                
                    <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                    <i class="fa fa-angle-right"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions"  href="#btn-open-shareoptions">
                <i class="fa fa-share-alt"></i>
            </a>
        </li>
        <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=http://gomugom.github.io/let-vs-var-performance-compare/">
                <i class="fa fa-google-plus"></i>
            </a>
        </li>
        <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://gomugom.github.io/let-vs-var-performance-compare/">
                <i class="fa fa-facebook-official"></i>
            </a>
        </li>
        <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=http://gomugom.github.io/let-vs-var-performance-compare/">
                <i class="fa fa-twitter"></i>
            </a>
        </li>
        
            <li class="post-action">
                <a class="post-action-btn btn btn--default" href="#disqus_thread">
                    <i class="fa fa-comment-o"></i>
                </a>
            </li>
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#">
            
                <i class="fa fa-list"></i>
            </a>
        </li>
    </ul>
</div>


        
            
                <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
            
        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2017 gomugom. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--disabled">
                
                    <i class="fa fa-angle-left"></i>
                    <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                </a>
            </li>
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--default tooltip--top" href="/ecmascript-proposals-1-intro/" data-tooltip="ECMAScript Proposals 1 - ES2016 &amp; ES2017">
                
                    <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                    <i class="fa fa-angle-right"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions"  href="#btn-open-shareoptions">
                <i class="fa fa-share-alt"></i>
            </a>
        </li>
        <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=http://gomugom.github.io/let-vs-var-performance-compare/">
                <i class="fa fa-google-plus"></i>
            </a>
        </li>
        <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://gomugom.github.io/let-vs-var-performance-compare/">
                <i class="fa fa-facebook-official"></i>
            </a>
        </li>
        <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=http://gomugom.github.io/let-vs-var-performance-compare/">
                <i class="fa fa-twitter"></i>
            </a>
        </li>
        
            <li class="post-action">
                <a class="post-action-btn btn btn--default" href="#disqus_thread">
                    <i class="fa fa-comment-o"></i>
                </a>
            </li>
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#">
            
                <i class="fa fa-list"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                <div id="share-options-bar" class="share-options-bar" data-behavior="4">
    <ul class="share-options">
        <li class="share-option">
            <a class="share-option-btn" target="new" href="https://plus.google.com/share?url=http://gomugom.github.io/let-vs-var-performance-compare/">
                <i class="fa fa-google-plus"></i><span>Share on Google Plus</span>
            </a>
        </li>
        <li class="share-option">
            <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://gomugom.github.io/let-vs-var-performance-compare/">
                <i class="fa fa-facebook-official"></i><span>Share on Facebook</span>
            </a>
        </li>
        <li class="share-option">
            <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=http://gomugom.github.io/let-vs-var-performance-compare/">
                <i class="fa fa-twitter"></i><span>Share on Twitter</span>
            </a>
        </li>
    </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>

            
        </div>
        


    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-remove"></i>
        </div>
        
            <img id="about-card-picture" src="https://www.gravatar.com/avatar/02e9f56a3202da2e6e0e36a5a23facbb?s=110" alt="Author&#39;s picture"/>
        
            <h4 id="about-card-name">gomugom</h4>
        
            <div id="about-card-bio"><p>호기심 많고 열정 넘치는 초보 개발자입니다. 도전을 좋아하며 매사를 즐기고자 노력합니다.</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>front-end developer</p>

            </div>
        
        
            <div id="about-card-location">
                <i class="fa fa-map-marker"></i>
                <br/>
                Seoul
            </div>
        
    </div>
</div>

        <div id="algolia-search-modal" class="modal-container">
    <div class="modal">
        <div class="modal-header">
            <span class="close-button"><i class="fa fa-close"></i></span>
            <a href="https://algolia.com" target="_blank" class="searchby-algolia text-color-light link-unstyled">
                <span class="searchby-algolia-text text-color-light text-small">by</span>
                <img class="searchby-algolia-logo" src="https://www.algolia.com/static_assets/images/press/downloads/algolia-light.svg">
            </a>
            <i class="search-icon fa fa-search"></i>
            <form id="algolia-search-form">
                <input type="text" id="algolia-search-input" name="search"
                    class="form-control input--large search-input" placeholder="Search "
                    autofocus="autofocus"/>
            </form>
        </div>
        <div class="modal-body">
            <div class="no-result text-color-light text-center">no post found</div>
            <div class="results">
                
                <div class="media">
                    
                    <div class="media-left">
                        <a class="link-unstyled" href="http://gomugom.github.io/is-class-only-a-syntactic-sugar/">
                            <img class="media-image" src="http://gomugom.github.io/is-class-only-a-syntactic-sugar/../images/category-es.png" width="90" height="90"/>
                        </a>
                    </div>
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="http://gomugom.github.io/is-class-only-a-syntactic-sugar/">
                            <h3 class="media-heading">ES6 Class는 단지 prototype 상속의 문법설탕일 뿐인가?</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2016년 10월 7일
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><p>/<em> 본 글은 지적 호기심에 따른 탐구과정을 <code>의식의 흐름 기법</code>에 따라 적어내려간 것이므로 내용전개가 매끄럽지 못할 수 있음을 미리 밝힙니다. </em>/</p>
<p>최근 모 커뮤니티에서 ‘ES6를 공부해야 할 필요는 없다’는 의견을 발견하였는데, 그 분의 견해를 읽던 중 ‘Class는 문법설탕일 뿐’이라는 내용에 대해서 정말로 그러한지 알아보고 싶은 마음이 들었습니다.</p></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-left">
                        <a class="link-unstyled" href="http://gomugom.github.io/atom-packages/">
                            <img class="media-image" src="http://gomugom.github.io/atom-packages/../images/category-etc.png" width="90" height="90"/>
                        </a>
                    </div>
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="http://gomugom.github.io/atom-packages/">
                            <h3 class="media-heading">Atom Editor 영업하는 글</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2016년 10월 18일
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><p>Atom 유저로서 패키지를 쓰고는 있는데, Sublime 쓰던 시절에는 블로그에서 여러 사람들의 추천패키지를 검색해서 쓸 수 있었던 반면 Atom 패키지에 대해서는 글을 찾기가 어려워 곤란함을 느꼈기에, 어느정도 사용에 익숙해졌으니 제가 직접 씁니다. 패키지 추천만 하면 (제가) 재미 없으니 잡설부터 들어갑니다. 아래부턴 구어체로…</p></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-left">
                        <a class="link-unstyled" href="http://gomugom.github.io/how-to-remove-node-from-macos/">
                            <img class="media-image" src="http://gomugom.github.io/how-to-remove-node-from-macos/../images/category-etc.png" width="90" height="90"/>
                        </a>
                    </div>
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="http://gomugom.github.io/how-to-remove-node-from-macos/">
                            <h3 class="media-heading">mac에서 `node.js`를 완전히 삭제하는 방법</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2016년 10월 20일
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><p>서로 다른 버전의 node가 하나의 shell 안에서 경쟁하는 구도가 되었다는 점이다. 여러 수단으로 node를 설치했음에도 아무 문제가 없는 분은 이쯤에서 뒤로가기를 살포시 눌러도 무방하나, 그렇지 않은 경우 아래의 방법에 따를 것을 강력히 추천한다.</p>
<p>(아래 내용은 본론만 소개하자니 어딘가 허전한 느낌이 들어 마구 휘갈긴 글로, 급하신 분들은 문장 건너뛰고 본론 파트로 넘어가시기 바랍니다.)</p></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-left">
                        <a class="link-unstyled" href="http://gomugom.github.io/how-to-make-private-member/">
                            <img class="media-image" src="http://gomugom.github.io/how-to-make-private-member/../images/category-es.png" width="90" height="90"/>
                        </a>
                    </div>
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="http://gomugom.github.io/how-to-make-private-member/">
                            <h3 class="media-heading">ES6 Class에서 private member를 정의하는 방법</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2016년 11월 27일
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><p>es6의 class 문법에는 private data를 직접 지정할 수 있는 기능이 제공되지 않는다.<br>때문에 private data로 쓰고자 하는 변수는 우회적으로 관리하여야 하는데, 그 방법들을 소개한다.</p></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-left">
                        <a class="link-unstyled" href="http://gomugom.github.io/es6-for-react/">
                            <img class="media-image" src="http://gomugom.github.io/es6-for-react/../images/category-es.png" width="90" height="90"/>
                        </a>
                    </div>
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="http://gomugom.github.io/es6-for-react/">
                            <h3 class="media-heading">ReactJS를 작성할 때에 알아두면 좋은 ES6 문법들</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2016년 11월 28일
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><p>ReactJS를 작성할 떄에 미리 알아두면 좋은 ES6 문법들을 소개한다.</p></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-left">
                        <a class="link-unstyled" href="http://gomugom.github.io/ecmascript-proposals-1-intro/">
                            <img class="media-image" src="http://gomugom.github.io/ecmascript-proposals-1-intro/../images/category-es.png" width="90" height="90"/>
                        </a>
                    </div>
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="http://gomugom.github.io/ecmascript-proposals-1-intro/">
                            <h3 class="media-heading">ECMAScript Proposals 1 - ES2016 &amp; ES2017</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2016년 12월 28일
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><p>tc39에서 진행하고 있는 ECMAScript의 다음 버전들 및 그 후보들을 알아본다.<br>그 중 본 글에서는 Stage 4(ES2016 및 ES2017에 새로 도입되기로 확정된 기능들)을 살펴보겠다.</p></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-left">
                        <a class="link-unstyled" href="http://gomugom.github.io/let-vs-var-performance-compare/">
                            <img class="media-image" src="http://gomugom.github.io/let-vs-var-performance-compare/../images/category-es.png" width="90" height="90"/>
                        </a>
                    </div>
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="http://gomugom.github.io/let-vs-var-performance-compare/">
                            <h3 class="media-heading">let과 var의 성능 비교</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2017년 1월 10일
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><p>며칠 전 김영보 강사님의 다음 글을 읽고 의문이 들어 직접 ES6의 <code>let</code>과 기존의 <code>var</code>의 성능 차이를 비교한 실험을 해보면서 그 내용을 정리하여 포스팅한다. 모든 테스트는 MacOS 10.11.6 / Chrome 55.0.2283.95 버전에서 수행하였다.</p></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
            </div>
        </div>
        <div class="modal-footer">
            <p class="results-count text-medium"
                data-message-zero="no post found"
                data-message-one="1 post found"
                data-message-other="{n} posts found">
                7 posts found
            </p>
        </div>
    </div>
</div>
        
<div id="cover" style="background-image:url('/assets/images/cover3.jpg');"></div>
        <!--SCRIPTS-->
<script src="/assets/js/script-wya9q71pzol6xzutg5qfcsgleoaqsioecksejuwritxrz9waoy3kaltzmt0c.min.js"></script>
<!--SCRIPTS END-->

    
        <script>
             var disqus_config = function () {
                 this.page.url = 'http://gomugom.github.io/let-vs-var-performance-compare/';
                 
                    this.page.identifier = 'let-vs-var-performance-compare/';
                 
             };
            (function() {
                var d = document, s = d.createElement('script');
                var disqus_shortname = 'gomugom';
                s.src = '//' + disqus_shortname + '.disqus.com/embed.js';

                s.setAttribute('data-timestamp', +new Date());
                (d.head || d.body).appendChild(s);
            })();
        </script>
    



    </body>
</html>
